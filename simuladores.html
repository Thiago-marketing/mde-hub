<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MDE Hub ‚Ä¢ Simuladores</title>

    <link rel="stylesheet" href="/css/app.css">
</head>

<body>

    <!-- BOT√ÉO MOBILE -->
    <div id="btnSidebarToggle">‚ò∞</div>

    <!-- SIDEBAR -->
    <div id="sidebar"></div>

    <!-- CONTE√öDO PRINCIPAL -->
    <main class="main-area">

        <!-- TOPBAR -->
        <div class="topbar">
            <div class="topbar-left">
                <h1 class="page-title">Simuladores Inteligentes</h1>
                <p class="page-subtitle">
                    Use os simuladores para entender performance, tarifas e proje√ß√µes da opera√ß√£o.
                </p>
            </div>

            <div class="topbar-right">
                <div class="hotel-select-wrapper">
                    <span class="label">Hotel selecionado</span>
                    <select id="hotelSelect">
                        <option>Carregando hot√©is...</option>
                    </select>
                </div>

                <button id="btnThemeToggle">üåì</button>
                <div class="user-badge" id="userMini">U</div>
            </div>
        </div>

        <!-- GRID DE SIMULADORES -->
        <section class="grid">

            <!-- SIMULADOR ADR -->
            <div class="card">
                <div class="card-title">Simulador de ADR</div>
                <div class="card-desc">
                    ADR = Faturamento de di√°rias √∑ N√∫mero de di√°rias vendidas.
                </div>

                <label for="adrFaturamento">Faturamento de di√°rias (R$)</label>
                <input type="number" id="adrFaturamento" placeholder="Ex: 12500,00" step="0.01">

                <label for="adrDiarias">Di√°rias vendidas</label>
                <input type="number" id="adrDiarias" placeholder="Ex: 80" step="1">

                <button id="btnCalcAdr">Calcular ADR</button>

                <p class="card-desc" style="margin-top:12px;">
                    ADR calculado: <strong id="adrResultado">--</strong>
                </p>
            </div>

            <!-- SIMULADOR REVPAR -->
            <div class="card">
                <div class="card-title">Simulador de RevPAR</div>
                <div class="card-desc">
                    RevPAR = Receita de hospedagem √∑ UH dispon√≠veis (no per√≠odo).
                </div>

                <label for="revReceita">Receita de hospedagem (R$)</label>
                <input type="number" id="revReceita" placeholder="Ex: 9800,00" step="0.01">

                <label for="revUhsDisp">UH dispon√≠veis no per√≠odo</label>
                <input type="number" id="revUhsDisp" placeholder="Ex: 120" step="1">

                <button id="btnCalcRevpar">Calcular RevPAR</button>

                <p class="card-desc" style="margin-top:12px;">
                    RevPAR calculado: <strong id="revResultado">--</strong>
                </p>
            </div>

            <!-- SIMULADOR OCUPA√á√ÉO -->
            <div class="card">
                <div class="card-title">Simulador de Ocupa√ß√£o</div>
                <div class="card-desc">
                    Ocupa√ß√£o = (UH ocupadas √∑ UH dispon√≠veis) √ó 100.
                </div>

                <label for="occOcupadas">UH ocupadas</label>
                <input type="number" id="occOcupadas" placeholder="Ex: 45" step="1">

                <label for="occDisponiveis">UH dispon√≠veis</label>
                <input type="number" id="occDisponiveis" placeholder="Ex: 60" step="1">

                <button id="btnCalcOcupacao">Calcular Ocupa√ß√£o</button>

                <p class="card-desc" style="margin-top:12px;">
                    Ocupa√ß√£o calculada: <strong id="occResultado">--</strong>
                </p>
            </div>

            <!-- SIMULADOR PROJE√á√ÉO -->
            <div class="card">
                <div class="card-title">Proje√ß√£o de Faturamento</div>
                <div class="card-desc">
                    Proje√ß√£o baseada em ADR, ocupa√ß√£o e UH dispon√≠veis.
                </div>

                <label for="projAdr">ADR (R$)</label>
                <input type="number" id="projAdr" placeholder="Ex: 230,00" step="0.01">

                <label for="projOcupacao">% Ocupa√ß√£o esperada</label>
                <input type="number" id="projOcupacao" placeholder="Ex: 70" step="0.01">

                <label for="projUhs">UH dispon√≠veis</label>
                <input type="number" id="projUhs" placeholder="Ex: 40" step="1">

                <label for="projDias">Dias no per√≠odo</label>
                <input type="number" id="projDias" placeholder="Ex: 30" step="1">

                <button id="btnCalcProjecao">Calcular Proje√ß√£o</button>

                <p class="card-desc" style="margin-top:12px;">
                    Faturamento estimado: <strong id="projResultado">--</strong>
                </p>
            </div>

        </section>

    </main>

    <!-- JS CORE -->
    <script type="module" src="/js/supabase.js"></script>
    <script type="module" src="/js/app.js"></script>

    <!-- SIDEBAR -->
    <script>
        fetch("/partials/sidebar.html")
            .then(r => r.text())
            .then(html => document.querySelector("#sidebar").innerHTML = html)
            .catch(err => console.error("Erro ao carregar sidebar:", err));
    </script>

    <!-- L√ìGICA DOS SIMULADORES (mock local, sem SQL) -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {

            // ADR
            document.getElementById("btnCalcAdr").addEventListener("click", () => {
                const faturamento = parseFloat(document.getElementById("adrFaturamento").value || "0");
                const diarias = parseFloat(document.getElementById("adrDiarias").value || "0");

                if (!faturamento || !diarias) {
                    alert("Informe faturamento e di√°rias para calcular o ADR.");
                    return;
                }

                const adr = faturamento / diarias;
                document.getElementById("adrResultado").innerText = "R$ " + adr.toFixed(2);
            });

            // RevPAR
            document.getElementById("btnCalcRevpar").addEventListener("click", () => {
                const receita = parseFloat(document.getElementById("revReceita").value || "0");
                const uhs = parseFloat(document.getElementById("revUhsDisp").value || "0");

                if (!receita || !uhs) {
                    alert("Informe receita e UH dispon√≠veis para calcular o RevPAR.");
                    return;
                }

                const revpar = receita / uhs;
                document.getElementById("revResultado").innerText = "R$ " + revpar.toFixed(2);
            });

            // Ocupa√ß√£o
            document.getElementById("btnCalcOcupacao").addEventListener("click", () => {
                const ocupadas = parseFloat(document.getElementById("occOcupadas").value || "0");
                const disponiveis = parseFloat(document.getElementById("occDisponiveis").value || "0");

                if (!ocupadas || !disponiveis) {
                    alert("Informe UH ocupadas e dispon√≠veis para calcular ocupa√ß√£o.");
                    return;
                }

                const taxa = (ocupadas / disponiveis) * 100;
                document.getElementById("occResultado").innerText = taxa.toFixed(1) + "%";
            });

            // Proje√ß√£o
            document.getElementById("btnCalcProjecao").addEventListener("click", () => {
                const adr = parseFloat(document.getElementById("projAdr").value || "0");
                const ocupacao = parseFloat(document.getElementById("projOcupacao").value || "0");
                const uhs = parseFloat(document.getElementById("projUhs").value || "0");
                const dias = parseFloat(document.getElementById("projDias").value || "0");

                if (!adr || !ocupacao || !uhs || !dias) {
                    alert("Preencha ADR, ocupa√ß√£o, UH e dias para calcular a proje√ß√£o.");
                    return;
                }

                // Proje√ß√£o simples: ADR √ó (UH √ó %ocupa√ß√£o) √ó dias
                const fatorOcupacao = ocupacao / 100;
                const diariasVendidas = uhs * fatorOcupacao * dias;
                const faturamento = adr * diariasVendidas;

                document.getElementById("projResultado").innerText = "R$ " + faturamento.toFixed(2);
            });

        });
    </script>

</body>
</html>
